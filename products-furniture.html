<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DveinMart - Furniture</title>
    <link rel="icon" href="/Images/Login/Round logo.png">
    <link rel="stylesheet" href="/Styles/products.css">
</head>

<body>

    <div class="top-header">
        <div class="header-left">
            <img src="/Images/Login/Login Logo.ico" alt="logo">
            <div class="header-title">DveinMart</div>
        </div>
        <div class="header-right">
            <button class="nav-btn" onclick="window.location='cart.html'">
                ðŸ›’ Cart
                <span id="cart-count" style="margin-left: 5px; background-color: var(--accent); color: #000; padding: 2px 7px; border-radius: 50%; font-weight: 600; font-size: 12px; display: none;">0</span>
            </button>
            <button class="nav-btn" onclick="window.location='login.html'">Login</button>
        </div>
    </div>
    
    <div class="nav-menu">
        <div class="nav-item" onclick="window.location='home.html'">Home</div>
        <div class="nav-item dropdown">Categories â–¾
            <div class="dropdown-menu">
                <div onclick="window.location='products-furniture.html'">Furniture</div>
                <div onclick="window.location='products-grocery.html'">Grocery</div>
                <div onclick="window.location='products-clothes.html'">Fashion</div>
                <div onclick="window.location='products-electronics.html'">Electronics</div>
            </div>
        </div>
        <div class="nav-item" onclick="window.location='home.html#about-section'">About</div>
        <div class="nav-item" onclick="window.location='home.html#support-section'">Support</div>
    </div>

    <h1 class="page-title">Furniture Collection</h1>

    <div class="sub-category-list">
        <div onclick="showCategory('Sofa')">Sofa</div>
        <div onclick="showCategory('Bed')">Bed</div>
        <div onclick="showCategory('Chair')">Chair</div>
        <div onclick="showCategory('Dining')">Dining Table</div>
        <div onclick="showCategory('Cabinet')">Cabinet</div>
    </div>

    <div id="product-container"></div>


    <script>
        // 3. ADD CART COUNT FUNCTION DEFINITION
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const countElement = document.getElementById('cart-count');

            if (countElement) {
                const totalCount = cart.reduce((total, item) => total + item.quantity, 0);

                if (totalCount > 0) {
                    countElement.textContent = totalCount;
                    countElement.style.display = 'inline';
                } else {
                    countElement.textContent = '0';
                    countElement.style.display = 'none';
                }
            }
        }
        
        /* Product lists â€” standardized to map format */
        const data = {
            Sofa: [1, 2, 3, 4].map(i => ({ name: `Luxury Sofa ${i}`, price: 24999 + i * 1000, img: `/Images/Products/Furniture/Sofa/sofa${i}.jpeg` })),
            Bed: [1, 2, 3, 4].map(i => ({ name: `King Bed ${i}`, price: 34999 + i * 1000, img: `/Images/Products/Furniture/Bed/bed${i}.jpeg` })),
            Chair: [1, 2, 3, 4].map(i => ({ name: `Chair ${i}`, price: 5999 + i * 500, img: `/Images/Products/Furniture/Chair/chair${i}.jpeg` })),
            Dining: [1, 2, 3, 4].map(i => ({ name: `Dining ${i}`, price: 19999 + i * 2000, img: `/Images/Products/Furniture/Dining/dining${i}.jpeg` })),
            Cabinet: [1, 2, 3, 4].map(i => ({ name: `Cabinet ${i}`, price: 12999 + i * 1000, img: `/Images/Products/Furniture/Cabinet/cabinet${i}.jpeg` }))
        };

        function showCategory(cat) {
            const list = data[cat] || [];
            let html = `<h2 class="sub-title">${cat}</h2><div class="product-grid">`;
            // Standardized loop for simpler code
            list.forEach(it => html += `<div class="product-card"><img src="${it.img}" alt="${it.name}"><h3>${it.name}</h3><p>â‚¹${it.price}</p><button onclick="addToCart('${escape(it.name)}',${it.price},'${it.img}')">+ Add</button></div>`);
            html += `</div>`;
            document.getElementById('product-container').innerHTML = html;
        }

        /* Start with Sofa */
        showCategory('Sofa');

        // Standardized addToCart function
        function addToCart(name, price, img) {
            name = unescape(name);
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const idx = cart.findIndex(i => i.name === name);
            if (idx >= 0) cart[idx].quantity += 1;
            else cart.push({ name, price, img, quantity: 1 });
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(name + ' added to cart');
            
            // 4. CALL: Update cart counter after adding item
            updateCartCount();
        }

        /* About / Support scroll functions (Kept for compatibility) */
        function scrollToAbout() { document.getElementById('about-section').scrollIntoView({ behavior: 'smooth' }); }
        function scrollToSupport() { document.getElementById('support-section').scrollIntoView({ behavior: 'smooth' }); }

        // 5. CALL: Load cart count on page load
        updateCartCount();

    </script>
</body>
</html>